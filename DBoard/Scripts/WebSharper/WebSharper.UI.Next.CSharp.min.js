(function(){var a=this,b=a.WebSharper=a.WebSharper||{},c=b.UI=b.UI||{},d=c.Next=c.Next||{},e=d.CSharp=d.CSharp||{},f=e.ViewExtensions=e.ViewExtensions||{},g=e.DocExtension=e.DocExtension||{},h=e.Client=e.Client||{},i=h.Helpers=h.Helpers||{},j=h.RouteMapBuilder=h.RouteMapBuilder||{},k=h.RouteItemParsers=h.RouteItemParsers||{},l=d&&d.View,m=d&&d.Doc,n=a.IntelliFactory,o=n&&n.Runtime,p=d&&d.Var,q=b&&b.List,r=d&&d.RouteMap,s=b&&b.Seq,t=b&&b.Unchecked,u=b&&b.Arrays,v=b&&b.Collections,w=v&&v.FSharpMap,x=b&&b.Option,y=v&&v.Map,z=b&&b.Nullable,A=b&&b.Operators;f.UpdateWhile=function(B,C,D){return l.UpdateWhile(C,D,B);};g.DocSeqCached=function(B,C,D){return m.ConvertSeqBy(C,o.Curried2(D),B);};i.seqRefToListRef=function(B){return p.Lens(B,q.ofSeq,o.Curried2(function(C,D){return D;}));};j=h.RouteMapBuilder=o.Class({Install:function(){var B,C,D,E,F,G;B=this.ToRouteMap();C=r.Install(B);D=(E=q.rev(this.renders),(F=o.Curried2(function(H,I){return H(function(J){return p.Set(C,J);},I);}),function(H){return q.map(F,H);})(E));G=C.get_View();return m.BindView(function(H){return s.pick(function(I){return I(H);},D);},G);},ToRouteMap:function(){var B,C;B=q.rev(this.links);C=q.rev(this.routes);return r.CreateWithQuery(function(D){return s.pick(function(E){return E(D);},B);},function(D){return s.pick(function(E){return E(D);},C);});},AddRender:function(B){this.renders=new q.T({$:1,$0:B,$1:this.renders});},AddLink:function(B){this.links=new q.T({$:1,$0:B,$1:this.links});},AddRoute:function(B){this.routes=new q.T({$:1,$0:B,$1:this.routes});}},null,j);j.New=o.Ctor(function(){this.links=new q.T({$:0});this.routes=new q.T({$:0});this.renders=new q.T({$:0});null;},j);k["System.Double"]=function(B){var C,D,E;C=B[0];return C.$==1?(D=(new a.RegExp("^[0-9](?:\\.[0-9]*)?$")).exec(C.$0),t.Equals(D,null)?null:{$:1,$0:[(E=u.get(D,0),a.parseFloat(E)),C.$1]}):null;};k["System.Int32"]=function(B){var C,D,E;C=B[0];return C.$==1?(D=(new a.RegExp("^[0-9]+$")).exec(C.$0),t.Equals(D,null)?null:{$:1,$0:[(E=u.get(D,0),a.parseInt(E,a.$1)),C.$1]}):null;};k["System.String"]=function(B){var C;C=B[0];return C.$==1?{$:1,$0:[C.$0,C.$1]}:null;};k.MakeLink=function(B){return function(C){var D,E,F,G,H,I,J,K,L,M;return B.$==1?(D=[new w.New([])],[q.append(x.toList(B.$1),(E=(F=function(N){var O,P,Q,R,S,T,U,V,W,X;O=N[0];P=N[1];Q=N[3];return t.Equals(P,0)?(R=Q(C[O]),D[0]=y.FoldBack(o.Curried3(function(Y,Z,_0){return _0.Add(Y,Z);}),R[1],D[0]),R[0]):t.Equals(P,1)?(S=(T=(Q(C[O]))[0],q.head(T)),D[0]=D[0].Add(O,S),new q.T({$:0})):t.Equals(P,2)?(U=C[O],(U!=null?U.$==1:false)?void(D[0]=D[0].Add(O,(V=(Q(U.$0))[0],q.head(V)))):null,new q.T({$:0})):t.Equals(P,3)?(W=C[O],W!=null?void(D[0]=D[0].Add(O,(X=(Q(z.get(W)))[0],q.head(X)))):null,new q.T({$:0})):A.FailWith("invalid QueryItem enum value");},function(N){return s.collect(F,N);})(B.$2),q.ofSeq(E))),D[0]]):B.$==2?[new q.T({$:1,$0:a.String(s.length(C)),$1:(G=(H=(I=B.$2,J=function(N){return N[0];},function(N){return J(I(N));}),function(N){return s.collect(H,N);})(C),q.ofSeq(G))}),new w.New([])]:B.$==3?[(K=(L=((M=function(N){var O;O=N[1];return function(P){return(O(P))[0];};},o.Curried2(function(N,O){return s.map2(M,N,O);}))(B.$0))(C),s.concat(L)),q.ofSeq(K)),new w.New([])]:[q.ofArray([a.String(C)]),new w.New([])];};};k.ParseRoute=function(B){var C,D,E;C=k.ParseShape(B);D=(E=function(F){return F[1].$==0?{$:1,$0:F[0]}:null;},function(F){return x.bind(E,F);});return function(F){return D(C(F));};};k.ParseShape=function(B){return function(C){var D,E,F,G,H,I,J,K,L,M,N,O;D=C[0];E=C[1];F=o.Curried3(function(P,Q,R){var S,T,U,V;S=P();T=((U=o.Curried2(function(W,X){var Y,Z,_0,_1,_2,_3,_4,_5,_6,_7;Y=X[0];Z=X[1];_0=X[2];return(W!=null?W.$==1:false)?(_1=W.$0,t.Equals(Z,0)?(_2=_0([_1,E]),(_2!=null?_2.$==1:false)?(S[Y]=_2.$0[0],{$:1,$0:_2.$0[1]}):null):t.Equals(Z,1)?(_3=y.TryFind(Y,E),_3==null?null:(S[Y]=_3.$0,{$:1,$0:_1})):t.Equals(Z,2)?(_4=y.TryFind(Y,E),(_4!=null?_4.$==1:false)?(_5=_0([q.ofArray([_4.$0]),new w.New([])]),(_5!=null?_5.$==1:false)?(S[Y]={$:1,$0:_5.$0[0]},{$:1,$0:_1}):null):(S[Y]=null,{$:1,$0:_1})):t.Equals(Z,3)?(_6=y.TryFind(Y,E),(_6!=null?_6.$==1:false)?(_7=_0([q.ofArray([_6.$0]),new w.New([])]),(_7!=null?_7.$==1:false)?(S[Y]=_7.$0[0],{$:1,$0:_1}):null):(S[Y]=null,{$:1,$0:_1})):A.FailWith("invalid QueryItem enum value")):null;}),o.Curried2(function(W,X){return u.fold(U,W,X);}))({$:1,$0:Q}))(R);return(V=function(W){return[S,W];},function(W){return x.map(V,W);})(T);});return B.$==1?B.$1==null?((F(B.$0))(D))(B.$2):(D.$==1?D.$0===B.$1.$0?(G=[D.$1,D.$0],true):false:false)?((F(B.$0))(G[0]))(B.$2):null:B.$==2?(H=B.$0,I=B.$1,J=k["System.Int32"]([D,E]),(K=function(P){var Q,R=P[0],S=u.create(R,null);Q=o.Curried2(function(T,U){var V;return T===R?{$:1,$0:[H(S),U]}:(V=I([U,E]),(V!=null?V.$==1:false)?(u.set(S,T,V.$0[0]),(Q(T+1))(V.$0[1])):null);});return(Q(0))(P[1]);},function(P){return x.bind(K,P);})(J)):B.$==3?(L=a.Array.prototype.constructor.apply(a.Array,[]),M=((N=o.Curried2(function(P,Q){var R,S;R=Q[0];return(S=function(T){var U,V;U=R([T,E]);return(V=function(W){L.push(W[0]);return W[1];},function(W){return x.map(V,W);})(U);},function(T){return x.bind(S,T);})(P);}),o.Curried2(function(P,Q){return u.fold(N,P,Q);}))({$:1,$0:D}))(B.$0),(O=function(P){return[L,P];},function(P){return x.map(O,P);})(M)):B.$0([D,E]);};};}());
